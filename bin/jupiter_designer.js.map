{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/index.js","node_modules/eventemitter3/index.js","src/controller/BackgroundMenuController.js","src/controller/BehaviourController.js","src/controller/ProjectMenuController.js","src/controller/TextureMenuController.js","src/controller/index.js","src/model/BackgroundModel.js","src/model/BehaviourModel.js","src/model/Model.js","src/model/ParticleModel.js","src/model/PredefinedModel.js","src/model/ProjectModel.js","src/model/TexturesModel.js","src/model/index.js","src/service/FileService.js","src/service/index.js","src/util/bind.js","src/util/index.js","src/util/inherit.js","src/view/MainView.js","src/view/Marker.js","src/view/ParticleView.js","src/view/extension/index.js","src/view/extension/slider.js","src/view/index.js","src/view/menu/AngularVelocityMenu.js","src/view/menu/BackgroundMenu.js","src/view/menu/ColorMenu.js","src/view/menu/GeneralMenu.js","src/view/menu/LifeMenu.js","src/view/menu/Menu.js","src/view/menu/PositionMenu.js","src/view/menu/ProjectMenu.js","src/view/menu/SizeMenu.js","src/view/menu/SubMenu.js","src/view/menu/TextureMenu.js","src/view/menu/index.js","src/view/stage/Stage.js","src/view/stage/StageBackground.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7GA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"jupiter_designer.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var MainView = require(\"./view\").MainView;\nvar texturesModel = require(\"./model\").texturesModel;\nvar predefinedModel = require(\"./model\").predefinedModel;\n\nwindow.addEventListener(\"load\", function() {\n\n\t//todo: extract\n\tPIXI.loader.use(function(resource, next) {\n\t\tif ((/\\.(jup)$/i).test(resource.name)) {\n\t\t\tvar start = resource.name.lastIndexOf(\"/\") + 1;\n\t\t\tvar end = resource.name.lastIndexOf(\".\");\n\t\t\tpredefinedModel.add(resource.name.substring(start, end), JSON.parse(resource.data));\n\t\t}\n\n\t\tnext();\n\t});\n\tPIXI.loader.add(\"assets/spritesheet.json\");\n\tPIXI.loader.add(texturesModel.getTextureUrls());\n\tPIXI.loader.add(predefinedModel.getConfigUrls());\n\tPIXI.loader.once(\"complete\", onLoaded);\n\tPIXI.loader.load();\n\n\tfunction onLoaded() {\n\t\ttexturesModel.setDefaultTexture();\n\t\tvar mainView = new MainView();\n\t}\n});\n\n\n\n","'use strict';\n\n//\n// We store our EE objects in a plain object whose properties are event names.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// `~` to make sure that the built-in object properties are not overridden or\n// used as an attack vector.\n// We also assume that `Object.create(null)` is available when the event name\n// is an ES6 Symbol.\n//\nvar prefix = typeof Object.create !== 'function' ? '~' : false;\n\n/**\n * Representation of a single EventEmitter function.\n *\n * @param {Function} fn Event handler to be called.\n * @param {Mixed} context Context for function execution.\n * @param {Boolean} once Only emit once\n * @api private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Minimal EventEmitter interface that is molded against the Node.js\n * EventEmitter interface.\n *\n * @constructor\n * @api public\n */\nfunction EventEmitter() { /* Nothing to set */ }\n\n/**\n * Holds the assigned EventEmitters by name.\n *\n * @type {Object}\n * @private\n */\nEventEmitter.prototype._events = undefined;\n\n/**\n * Return a list of assigned event listeners.\n *\n * @param {String} event The events that should be listed.\n * @param {Boolean} exists We only need to know if there are listeners.\n * @returns {Array|Boolean}\n * @api public\n */\nEventEmitter.prototype.listeners = function listeners(event, exists) {\n  var evt = prefix ? prefix + event : event\n    , available = this._events && this._events[evt];\n\n  if (exists) return !!available;\n  if (!available) return [];\n  if (available.fn) return [available.fn];\n\n  for (var i = 0, l = available.length, ee = new Array(l); i < l; i++) {\n    ee[i] = available[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Emit an event to all registered event listeners.\n *\n * @param {String} event The name of the event.\n * @returns {Boolean} Indication if we've emitted an event.\n * @api public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events || !this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if ('function' === typeof listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Register a new EventListener for the given event.\n *\n * @param {String} event Name of the event.\n * @param {Functon} fn Callback function.\n * @param {Mixed} context The context of the function.\n * @api public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  var listener = new EE(fn, context || this)\n    , evt = prefix ? prefix + event : event;\n\n  if (!this._events) this._events = prefix ? {} : Object.create(null);\n  if (!this._events[evt]) this._events[evt] = listener;\n  else {\n    if (!this._events[evt].fn) this._events[evt].push(listener);\n    else this._events[evt] = [\n      this._events[evt], listener\n    ];\n  }\n\n  return this;\n};\n\n/**\n * Add an EventListener that's only called once.\n *\n * @param {String} event Name of the event.\n * @param {Function} fn Callback function.\n * @param {Mixed} context The context of the function.\n * @api public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  var listener = new EE(fn, context || this, true)\n    , evt = prefix ? prefix + event : event;\n\n  if (!this._events) this._events = prefix ? {} : Object.create(null);\n  if (!this._events[evt]) this._events[evt] = listener;\n  else {\n    if (!this._events[evt].fn) this._events[evt].push(listener);\n    else this._events[evt] = [\n      this._events[evt], listener\n    ];\n  }\n\n  return this;\n};\n\n/**\n * Remove event listeners.\n *\n * @param {String} event The event we want to remove.\n * @param {Function} fn The listener that we need to find.\n * @param {Mixed} context Only remove listeners matching this context.\n * @param {Boolean} once Only remove once listeners.\n * @api public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events || !this._events[evt]) return this;\n\n  var listeners = this._events[evt]\n    , events = [];\n\n  if (fn) {\n    if (listeners.fn) {\n      if (\n           listeners.fn !== fn\n        || (once && !listeners.once)\n        || (context && listeners.context !== context)\n      ) {\n        events.push(listeners);\n      }\n    } else {\n      for (var i = 0, length = listeners.length; i < length; i++) {\n        if (\n             listeners[i].fn !== fn\n          || (once && !listeners[i].once)\n          || (context && listeners[i].context !== context)\n        ) {\n          events.push(listeners[i]);\n        }\n      }\n    }\n  }\n\n  //\n  // Reset the array, or remove it completely if we have no more listeners.\n  //\n  if (events.length) {\n    this._events[evt] = events.length === 1 ? events[0] : events;\n  } else {\n    delete this._events[evt];\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners or only the listeners for the specified event.\n *\n * @param {String} event The event want to remove all listeners for.\n * @api public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  if (!this._events) return this;\n\n  if (event) delete this._events[prefix ? prefix + event : event];\n  else this._events = prefix ? {} : Object.create(null);\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// This function doesn't apply anymore.\n//\nEventEmitter.prototype.setMaxListeners = function setMaxListeners() {\n  return this;\n};\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","var backgroundModel = require(\"../model\").backgroundModel;\nvar service = require(\"../service\");\n\nfunction BackgroundMenuController() {\n\tservice.msg.on(\"background/changeLocked\", this.onChangeLocked);\n\tservice.msg.on(\"background/changeColor\", this.onChangeColor);\n\tservice.msg.on(\"background/loadTexture\", this.onLoadTexture);\n\tservice.msg.on(\"background/removeTexture\", this.onRemoveTexture);\n}\n\nBackgroundMenuController.prototype.onChangeLocked = function() {\n\tbackgroundModel.isLocked = !backgroundModel.isLocked;\n};\n\nBackgroundMenuController.prototype.onChangeColor = function(value) {\n\tbackgroundModel.color = value;\n};\n\nBackgroundMenuController.prototype.onLoadTexture = function() {\n\tvar reader = new FileReader();\n\treader.onload = function() {\n\t\tbackgroundModel.texture = PIXI.Texture.fromImage(reader.result);\n\t\tdocument.getElementById(\"load-background\").value = null;\n\t}.bind(this);\n\n\treader.readAsDataURL(document.getElementById(\"load-background\").files[0]);\n};\n\nBackgroundMenuController.prototype.onRemoveTexture = function() {\n\tbackgroundModel.texture = null;\n};\nmodule.exports = BackgroundMenuController;","var projectModel = require(\"../model\").projectModel;\nvar service = require(\"../service\");\nvar util = require(\"../util\");\n\nfunction BehaviourController() {\n\tutil.bind(this);\n\tservice.msg.on(\"behaviour/setEnable\", this.onSetEnable);\n}\n\nBehaviourController.prototype.onSetEnable = function(enable, behaviour) {\n\tif (enable) {\n\t\tthis.enableBehaviour(behaviour);\n\t}\n\telse {\n\t\tthis.disableBehaviour(behaviour);\n\t}\n};\n\nBehaviourController.prototype.enableBehaviour = function(behaviour) {\n\tif (!projectModel.hasActiveBehaviour(behaviour)) {\n\t\tprojectModel.emitter.behaviours.add(behaviour);\n\t}\n};\n\nBehaviourController.prototype.disableBehaviour = function(behaviour) {\n\tvar behaviours = projectModel.emitter.behaviours.getAll();\n\tprojectModel.emitter.behaviours.clear();\n\n\tfor (var i = 0; i < behaviours.length; ++i) {\n\t\tif (behaviours[i].getName() !== behaviour.getName()) {\n\t\t\tprojectModel.emitter.behaviours.add(behaviours[i]);\n\t\t}\n\t}\n\n};\n\nmodule.exports = BehaviourController;\n","var file = require(\"../service\").file;\nvar service = require(\"../service\");\nvar projectModel = require(\"../model\").projectModel;\nvar predefinedModel = require(\"../model\").predefinedModel;\nvar behaviourModel = require(\"../model\").behaviourModel;\nvar texturesModel = require(\"../model\").texturesModel;\nvar backgroundModel = require(\"../model\").backgroundModel;\n\nfunction ProjectMenuController() {\n\tservice.msg.on(\"project/save\", this.onSaveProject, this);\n\tservice.msg.on(\"project/load\", this.onLoadProject, this);\n\tservice.msg.on(\"project/exportConfig\", this.onExportConfig, this);\n\tservice.msg.on(\"project/loadConfig\", this.onLoadConfig, this);\n\tservice.msg.on(\"project/loadPredefined\", this.onLoadPredefined, this);\n\n\tprojectModel.on(\"emitterConfig/changed\", this.refreshBehaviours);\n}\n\nProjectMenuController.prototype.onLoadProject = function() {\n\tvar reader = new FileReader();\n\treader.onload = function() {\n\t\tvar data = JSON.parse(reader.result);\n\t\tthis.loadProject(data);\n\n\t}.bind(this);\n\n\treader.readAsText(document.getElementById(\"load-project\").files[0]);\n};\n\nProjectMenuController.prototype.loadProject = function(data) {\n\tprojectModel.deserialize(data.project);\n\ttexturesModel.deserialize(data.texture);\n\tbackgroundModel.deserialize(data.background);\n\n\tservice.msg.emit(\"project/loaded\");\n};\n\nProjectMenuController.prototype.onSaveProject = function() {\n\tvar data = {};\n\tdata.project = projectModel.serialize();\n\tdata.texture = texturesModel.serialize();\n\tdata.background = backgroundModel.serialize();\n\n\tfile.saveAs(\"project.jup\", data);\n};\n\nProjectMenuController.prototype.onExportConfig = function() {\n\tfile.saveAsJson(\"particle_config\", projectModel.emitter.getParser().write());\n};\n\nProjectMenuController.prototype.onLoadConfig = function() {\n\tvar reader = new FileReader();\n\treader.onload = function() {\n\t\tprojectModel.setEmitterConfig(JSON.parse(reader.result));\n\t}.bind(this);\n\n\treader.readAsText(document.getElementById(\"load-config\").files[0]);\n};\n\nProjectMenuController.prototype.reset = function() {\n\tthis.onLoadPredefined(\"radial\");\n};\n\nProjectMenuController.prototype.onLoadPredefined = function(name) {\n\tthis.loadProject(predefinedModel.getByName(name));\n\t//projectModel.setEmitterConfig(predefinedModel.getByName(name));\n};\n\nProjectMenuController.prototype.refreshBehaviours = function() {\n\tvar behaviours = projectModel.emitter.behaviours.getAll();\n\tfor (var i = 0; i < behaviours.length; i++) {\n\t\tbehaviourModel.addBehaviour(behaviours[i]);\n\t}\n\tservice.msg.emit(\"emitter/changed\");\n};\n\nmodule.exports = ProjectMenuController;","var service = require(\"../service\");\nvar texturesModel = require(\"../model\").texturesModel;\n\nfunction TextureMenuController() {\n\tservice.msg.on(\"texture/change\", this.onTextureChange);\n\tservice.msg.on(\"texture/upload\", this.onUploadTexture);\n}\n\nTextureMenuController.prototype.exportParticleTexture = function() {\n\n};\n\nTextureMenuController.prototype.onTextureChange = function(name) {\n\ttexturesModel.setTextureByName(name);\n};\n\nTextureMenuController.prototype.onUploadTexture = function() {\n\tvar reader = new FileReader();\n\treader.onload = function() {\n\t\ttexturesModel.setTexture(PIXI.Texture.fromImage(reader.result));\n\t\tdocument.getElementById(\"load-texture\").value = null;\n\n\t}.bind(this);\n\n\treader.readAsDataURL(document.getElementById(\"load-texture\").files[0]);\n};\n\nmodule.exports = TextureMenuController;","var ProjectMenuController = require(\"./ProjectMenuController.js\");\nvar TextureMenuController = require(\"./TextureMenuController.js\");\nvar BackgroundMenuController = require(\"./BackgroundMenuController.js\");\nvar BehaviourController = require(\"./BehaviourController.js\");\n\nmodule.exports = {\n\tprojectMenuController: new ProjectMenuController(),\n\ttextureMenuController: new TextureMenuController(),\n\tbackgroundMenuController: new BackgroundMenuController(),\n\tbehaviourController: new BehaviourController()\n};","var Model = require(\"./Model.js\");\nvar util = require(\"../util\");\n\nfunction BackgroundModel() {\n\tModel.call(this);\n\n\tthis.property(\"color\", 0x0000);\n\tthis.property(\"isLocked\", true);\n\tthis.property(\"texture\", null);\n\tthis.property(\"imagePosition\", new PIXI.Point(0, 0));\n}\n\nutil.inherit(BackgroundModel, Model);\n\nBackgroundModel.prototype.serialize = function() {\n\tvar data = {};\n\tdata.color = this.color;\n\tdata.isLocked = this.isLocked;\n\tdata.imagePosition = {x: this.imagePosition.x, y: this.imagePosition.y};\n\tif (this.texture) {\n\t\tdata.textureUrl = this.texture.baseTexture.imageUrl;\n\t}\n\n\treturn data;\n};\n\nBackgroundModel.prototype.deserialize = function(data) {\n\tthis.color = data.color || 0x0000;\n\tthis.isLocked = data.isLocked || true;\n\tthis.imagePosition = new PIXI.Point(data.imagePosition.x, data.imagePosition.y);\n\n\tif (data.textureUrl) {\n\t\tthis.texture = PIXI.Texture.fromImage(data.textureUrl);\n\t}\n};\n\nmodule.exports = BackgroundModel;","function BehaviourModel() {\n\n\tthis.behaviours = {};\n\tthis.addBehaviour(new jupiter.LifeBehaviour());\n\tthis.addBehaviour(new jupiter.PositionBehaviour());\n\tthis.addBehaviour(new jupiter.ColorBehaviour());\n\tthis.addBehaviour(new jupiter.SizeBehaviour());\n\tthis.addBehaviour(new jupiter.AngularVelocityBehaviour());\n}\n\nBehaviourModel.prototype.addBehaviour = function(behaviour) {\n\tif (this.behaviours[behaviour.getName()]) {\n\t\tthis.behaviours[behaviour.getName()] = null;\n\t\tdelete this.behaviours[behaviour.getName()];\n\t}\n\n\tthis.behaviours[behaviour.getName()] = behaviour;\n};\n\nBehaviourModel.prototype.getBehaviourByName = function(name) {\n\tif (!this.behaviours[name]) {\n\t\tthrow new Error(\"No behaviour by given name = \" + name);\n\t}\n\n\treturn this.behaviours[name];\n};\n\nmodule.exports = BehaviourModel;","var EventEmitter = require(\"eventemitter3\");\nvar util = require(\"../util\");\n\nfunction Model() {\n\tEventEmitter.call(this);\n\tutil.bind(this);\n}\n\nutil.inherit(Model, EventEmitter);\n\nModel.prototype.property = function(property, defaultValue) {\n\tvar _value;\n\tObject.defineProperty(this, property, {\n\t\tget: function() {\n\t\t\treturn _value;\n\t\t},\n\t\tset: function(value) {\n\t\t\tif (_value !== value) {\n\t\t\t\tvar prev = _value;\n\t\t\t\t_value = value;\n\t\t\t\tthis.emit(property + \"/changed\", value, prev);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (defaultValue !== undefined) {\n\t\tthis[property] = defaultValue;\n\t}\n};\n\nmodule.exports = Model;","function ParticleModel(){\n\tthis.texture = null;\n\tthis.name = null;\n\tthis.predefined = false;\n}\n\n\nmodule.exports = ParticleModel;","function PredefinedModel() {\n\tthis.configs = {};\n}\n\nPredefinedModel.prototype.add = function(name, config) {\n\tthis.configs[name] = config;\n};\n\nPredefinedModel.prototype.getByName = function(name) {\n\treturn this.configs[name];\n};\n\nPredefinedModel.prototype.getAllConfigs = function() {\n\treturn this.configs; //todo: concat?\n};\n\nPredefinedModel.prototype.getNames = function() {\n\treturn Object.keys(this.configs);\n};\n\nPredefinedModel.prototype.getConfigUrls = function() {\n\treturn [\n\t\t\"assets/config/default.jup\",\n\t\t\"assets/config/firework.jup\",\n\t\t\"assets/config/green_chaos.jup\",\n\t\t\"assets/config/radial.jup\"\n\t];\n};\n\nmodule.exports = PredefinedModel;","var Model = require(\"./Model.js\");\nvar util = require(\"../util\");\n\nfunction ProjectModel() {\n\tModel.call(this);\n\n\tthis.stageSize = new PIXI.Point(600, 600);\n\tthis.emitter = new jupiter.Emitter();\n\tthis.property(\"markerPosition\", new PIXI.Point(0.5, 0.5));\n}\n\nutil.inherit(ProjectModel, Model);\n\nProjectModel.prototype.hasActiveBehaviour = function(behaviour) {\n\tvar behavious = this.emitter.behaviours.getAll();\n\n\tfor (var i = 0; i < behavious.length; ++i) {\n\t\tif (behavious[i].getName() === behaviour.getName()) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n};\n\nProjectModel.prototype.serialize = function() {\n\tvar data = {};\n\tdata.emitterConfig = this.emitter.getParser().write();\n\tdata.markerPosition = {x: this.markerPosition.x, y: this.markerPosition.y};\n\n\treturn data;\n};\n\nProjectModel.prototype.deserialize = function(data) {\n\tthis.markerPosition = new PIXI.Point(data.markerPosition.x, data.markerPosition.y);\n\tthis.setEmitterConfig(data.emitterConfig);\n};\n\nProjectModel.prototype.setEmitterConfig = function(config) {\n\tthis.emitter.getParser().read(config);\n\tthis.emit(\"emitterConfig/changed\");\n};\n\nObject.defineProperty(ProjectModel.prototype, \"markerPositionInStageCoordinates\", {\n\tget: function() {\n\t\treturn new PIXI.Point(this.markerPosition.x * this.stageSize.x, this.markerPosition.y * this.stageSize.y);\n\t},\n\tset: function(value) {\n\t\tthis.markerPosition = new PIXI.Point(value.x / this.stageSize.x, value.y / this.stageSize.y);\n\t}\n});\nmodule.exports = ProjectModel;","var Model = require(\"./Model.js\");\nvar util = require(\"../util\");\n\nvar PREDEFINED_TEXTURES = [\n\t{name: \"flare_blue\", url: \"assets/flare_blue.png\"},\n\t{name: \"cloud\", url: \"assets/cloud.png\"},\n\t{name: \"cloud2\", url: \"assets/cloud2.png\"},\n\t{name: \"flare\", url: \"assets/flare.png\"},\n\t{name: \"sparkle\", url: \"assets/sparkle.png\"},\n\t{name: \"circle\", url: \"assets/circle.png\"}\n];\n\nfunction TexturesModel() {\n\tModel.call(this);\n\n\tthis.textures = PREDEFINED_TEXTURES.concat();\n\tthis.currentTextureName = null;\n\tthis.property(\"currentTexture\", null);\n}\n\nutil.inherit(TexturesModel, Model);\n\nTexturesModel.prototype.setDefaultTexture = function() {\n\tthis.setTextureByName(\"circle\");\n};\n\nTexturesModel.prototype.setTextureByName = function(name) {\n\tvar url;\n\tfor (var i = 0; i < this.textures.length; i++) {\n\t\tif (this.textures[i].name === name) {\n\t\t\turl = this.textures[i].url;\n\t\t}\n\t}\n\tthis.currentTextureName = name;\n\tthis.currentTexture = PIXI.Texture.fromFrame(url);\n};\n\nTexturesModel.prototype.setTexture = function(texture) {\n\tthis.currentTextureName = null;\n\tthis.currentTexture = texture;\n};\n\nTexturesModel.prototype.getCurrentTexture = function() {\n\treturn this.currentTexture;\n};\n\nTexturesModel.prototype.getTextures = function() {\n\treturn this.textures;\n};\n\nTexturesModel.prototype.getTextureUrls = function() {\n\treturn this.getTextures().map(function(texture) {\n\t\treturn texture.url;\n\t});\n};\n\nTexturesModel.prototype.serialize = function() {\n\treturn {name: this.currentTextureName, url: this.currentTexture.baseTexture.imageUrl};\n};\n\nTexturesModel.prototype.deserialize = function(data) {\n\tif (data.name) {\n\t\tthis.setTextureByName(data.name);\n\t}\n\telse {\n\t\tthis.setTexture(PIXI.Texture.fromImage(data.url));\n\t}\n};\n\nmodule.exports = TexturesModel;","var ProjectModel = require(\"./ProjectModel.js\");\nvar BackgroundModel = require(\"./BackgroundModel.js\");\nvar ParticleModel = require(\"./ParticleModel.js\");\nvar BehaviourModel = require(\"./BehaviourModel.js\");\nvar PredefinedModel = require(\"./PredefinedModel.js\");\nvar TexturesModel = require(\"./TexturesModel.js\");\n\nmodule.exports = {\n\tprojectModel: new ProjectModel(),\n\tparticleModel: new ParticleModel(),\n\tbehaviourModel: new BehaviourModel(),\n\tpredefinedModel: new PredefinedModel(),\n\ttexturesModel: new TexturesModel(),\n\tbackgroundModel: new BackgroundModel()\n};","function FileService() {\n\n}\n\nFileService.prototype.saveAsJson = function(name, data) {\n\tthis.saveAs(name + \".json\", data);\n};\n\nFileService.prototype.saveAs = function(name, data) {\n\tconsole.log(\"save as \", name, \"data \", data);\n\tvar blob = new Blob([JSON.stringify(data)], {type: \"application/json\"});\n\tsaveAs(blob, name);\n};\n\nmodule.exports = FileService;","var FileService = require(\"./FileService.js\");\nvar EventEmitter = require(\"eventemitter3\");\n\nmodule.exports = {\n\tmsg: new EventEmitter(),\n\tfile: new FileService()\n};","module.exports = function(scope) {\n\tfor (var i in scope) {\n\t\tif (typeof scope[i] === \"function\") {\n\t\t\tscope[i] = scope[i].bind(scope);\n\t\t}\n\t}\n};","module.exports = {\n\tinherit: require(\"./inherit.js\"),\n\tbind: require(\"./bind.js\")\n};","module.exports = function(childClass, baseClass) {\n\tchildClass.prototype = Object.create(baseClass.prototype);\n\tchildClass.prototype.constructor = childClass;\n};","var Menu = require(\"./menu/Menu.js\");\nvar ParticleView = require(\"./ParticleView.js\");\nvar Stage = require(\"./stage/Stage.js\");\nvar backgroundModel = require(\"../model\").backgroundModel;\nvar service = require(\"../service\");\n\nfunction MainView() {\n\tthis.renderer = this.createRenderer();\n\tthis.stage = this.createStage();\n\tthis.stats = this.createStats();\n\tthis.particleView = this.createParticleView();\n\tthis.menu = this.createMenu();\n\n\tservice.msg.emit(\"project/loadPredefined\", \"default\");\n\tthis.draw();\n}\n\nMainView.prototype.createStage = function() {\n\t//todo: size from \n\treturn new Stage(new PIXI.Rectangle(0, 0, 600, 600));\n};\n\nMainView.prototype.createRenderer = function() {\n\t//todo: autodetect renderer\n\t//todo: dynamic size of renderer\n\tvar renderer = new PIXI.WebGLRenderer(600, 600);\n\tdocument.getElementById(\"stage\").appendChild(renderer.view);\n\n\tbackgroundModel.on(\"color/changed\", function(value) {\n\t\trenderer.backgroundColor = value;\n\t});\n\treturn renderer;\n};\n\nMainView.prototype.createStats = function() {\n\tvar stats = new Stats();\n\tstats.domElement.style.position = \"absolute\";\n\tstats.domElement.style.left = \"0px\";\n\tstats.domElement.style.top = \"0px\";\n\tdocument.body.appendChild(stats.domElement);\n\treturn stats;\n};\n\nMainView.prototype.createMenu = function() {\n\treturn new Menu();\n};\n\nMainView.prototype.createParticleView = function() {\n\treturn this.stage.addChild(new ParticleView());\n};\n\nMainView.prototype.draw = function() {\n\tPIXI.ticker.shared.add(function() {\n\t\tthis.stats.begin();\n\t\tthis.renderer.render(this.stage);\n\t\tthis.stats.end();\n\t}, this);\n};\n\nmodule.exports = MainView;","var util = require(\"../util\");\nvar service = require(\"../service\");\n\nfunction Marker(onDrag) {\n\tPIXI.Container.call(this);\n\tutil.bind(this);\n\n\tthis.onDrag = onDrag;\n\tthis.interactive = true;\n\tthis.buttonMode = true;\n\tthis.dragging = false;\n\tthis.image = this.createImage();\n\n\tthis.mousedown = this.touchstart = this.onMouseDown;\n\tthis.mouseup = this.mouseupoutside = this.touchend = this.touchendoutside = this.onMouseUp;\n\tthis.mousemove = this.touchmove = this.onMouseMove;\n\n\tservice.msg.on(\"stage/mouseOver\", this.onMouseOverStage);\n\tservice.msg.on(\"stage/mouseOut\", this.onMouseOutStage);\n}\n\nutil.inherit(Marker, PIXI.Container);\n\nMarker.prototype.createImage = function() {\n\tvar image = PIXI.Sprite.fromFrame(\"marker.png\");\n\timage.anchor.set(0.5, 0.5);\n\timage.alpha = 0.7;\n\n\treturn this.addChild(image);\n};\n\nMarker.prototype.onMouseDown = function() {\n\tthis.dragging = true;\n};\n\nMarker.prototype.onMouseUp = function() {\n\tthis.dragging = false;\n};\n\nMarker.prototype.onMouseMove = function(event) {\n\tif (this.dragging) {\n\t\tvar newPosition = event.data.getLocalPosition(this.parent);\n\t\tthis.onDrag(newPosition);\n\t}\n};\n\nMarker.prototype.onMouseOverStage = function() {\n\tthis.image.alpha = 0.5;\n};\n\nMarker.prototype.onMouseOutStage = function() {\n\tthis.image.alpha = 0.2;\n};\n\nmodule.exports = Marker;","var util = require(\"../util\");\nvar service = require(\"../service\");\nvar projectModel = require(\"../model\").projectModel;\nvar texturesModel = require(\"../model\").texturesModel;\n\nfunction ParticleView() {\n\tPIXI.Container.call(this);\n\tutil.bind(this);\n\n\tvar renderer = new jupiter.Renderer(projectModel.emitter, texturesModel.getCurrentTexture());\n\tthis.renderer = this.addChild(renderer);\n\n\tprojectModel.on(\"markerPosition/changed\", this.refreshRendererPosition);\n\ttexturesModel.on(\"currentTexture/changed\", this.onTextureChanged);\n\tservice.msg.on(\"project/loaded\", this.onProjectLoaded);\n\tprojectModel.emitter.on(\"emitter/complete\", this.onComplete);\n\n\tthis.refreshRendererPosition();\n}\n\nutil.inherit(ParticleView, PIXI.Container);\n\nParticleView.prototype.refreshRendererPosition = function() {\n\tthis.renderer.position = projectModel.markerPositionInStageCoordinates;\n};\n\nParticleView.prototype.onTextureChanged = function() {\n\tthis.renderer.texture = texturesModel.getCurrentTexture();\n};\n\nParticleView.prototype.onProjectLoaded = function() {\n\tprojectModel.emitter.reset();\n};\n\nParticleView.prototype.onComplete = function() {\n\tprojectModel.emitter.resetAndPlay();\n};\n\nmodule.exports = ParticleView;\n\n","module.exports = {\n\tslider: require(\"./slider.js\")\n};","module.exports = function(title, style) {\n\tstyle = style || {};\n\n\tvar step = style.step || 1;\n\tvar min = style.min || 0;\n\tvar max = style.max || 100;\n\n\tstyle.step = 1;\n\tstyle.title = title + \" \" + style.value;\n\tstyle.min = min / step;\n\tstyle.max = max / step;\n\tstyle.value = (style.value - min) / step;\n\n\tvar update = function(slider, invokeOnChanged) {\n\t\tvar value = ((slider.getValue() * step)).toFixed(step < 1 ? 2 : 0);\n\t\tslider.define(\"title\", title + \" \" + value);\n\t\tslider.refresh();\n\n\t\tif (slider.onChanged && invokeOnChanged) {\n\t\t\tslider.onChanged(parseFloat(value));\n\t\t}\n\t};\n\n\tstyle.setValue = function(value) {\n\t\t$$(style.id).config.value = ((value) / step);\n\t\tupdate($$(style.id), false);\n\t};\n\n\tstyle.on = {\n\t\tonChange: function() {\n\t\t\tupdate(this, true);\n\t\t},\n\t\tonSliderDrag: function() {\n\t\t\tupdate(this, true);\n\t\t}\n\t};\n\n\treturn style;\n};","module.exports = {\n\tmenu: require(\"./menu\"),\n\tMainView: require(\"./MainView.js\")\n};","var SubMenu = require(\"./SubMenu.js\");\nvar inherit = require(\"../../util\").inherit;\nvar bind = require(\"../../util\").bind;\nvar behaviourModel = require(\"../../model\").behaviourModel;\nvar projectModel = require(\"../../model\").projectModel;\nvar service = require(\"../../service\");\n\nfunction AngularVelocityMenu() {\n\tSubMenu.call(this);\n\tbind(this);\n\n\tthis.ui = {\n\t\trows: [\n\t\t\tthis.checkbox(\"Enabled: \", {id: \"angular_velocity_enable\", value: 0}),\n\t\t\tthis.rangedSlider(\"degrees\", \"Degrees/sec:\"),\n\t\t\tthis.rangedSlider(\"degrees_variance\", \"Degrees variance/sec:\"),\n\t\t\tthis.rangedSlider(\"max_radius\", \"Max radius:\"),\n\t\t\tthis.rangedSlider(\"max_radius_variance\", \"Max radius variance:\"),\n\t\t\tthis.rangedSlider(\"min_radius\", \"Min radius:\"),\n\t\t\tthis.rangedSlider(\"min_radius_variance\", \"Min radius variance:\")\n\t\t]\n\t};\n}\n\ninherit(AngularVelocityMenu, SubMenu);\n\nAngularVelocityMenu.prototype.rangedSlider = function(id, label) {\n\tvar slider = this.slider(label, {\n\t\tid: id,\n\t\tlabelWidth: 30,\n\t\tmin: -1000,\n\t\tmax: 1000,\n\t\tstep: 0.01,\n\t\tvalue: 0\n\t});\n\n\treturn slider;\n};\n\nAngularVelocityMenu.prototype.onMenuCreated = function() {\n\tthis.bind(\"degrees\", \"degrees\");\n\tthis.bind(\"degrees_variance\", \"degreesVariance\");\n\n\tthis.bind(\"max_radius\", \"maxRadius\");\n\tthis.bind(\"max_radius_variance\", \"maxRadiusVariance\");\n\n\tthis.bind(\"min_radius\", \"minRadius\");\n\tthis.bind(\"min_radius_variance\", \"minRadiusVariance\");\n\n\t$$(\"angular_velocity_enable\").attachEvent(\"onChange\", this.onEnableChanged);\n\tservice.msg.on(\"emitter/changed\", this.onEmitterChanged);\n};\n\nAngularVelocityMenu.prototype.onEnableChanged = function(value) {\n\tservice.msg.emit(\"behaviour/setEnable\", value, this.getBehaviour());\n};\n\nAngularVelocityMenu.prototype.onEmitterChanged = function() {\n\t$$(\"angular_velocity_enable\").setValue(projectModel.hasActiveBehaviour(this.getBehaviour()));\n};\n\nAngularVelocityMenu.prototype.getBehaviour = function() {\n\treturn behaviourModel.getBehaviourByName(\"AngularVelocityBehaviour\");\n};\n\nmodule.exports = AngularVelocityMenu;\n\n\n","var SubMenu = require(\"./SubMenu.js\");\nvar util = require(\"../../util\");\nvar service = require(\"../../service\");\nvar backgroundModel = require(\"../../model\").backgroundModel;\n\nfunction BackgroundMenu() {\n\tSubMenu.call(this);\n\tutil.bind(this);\n\n\tthis.ui = {\n\t\trows: [\n\t\t\tthis.checkbox(\"Locked: \", {id: \"lock_enable\", value: backgroundModel.isLocked}),\n\t\t\tthis.button(\"Load image\", {click: this.onLoadImage}),\n\t\t\tthis.button(\"Remove background\", {click: this.onRemoveBackground}),\n\t\t\t{view: \"colorpicker\", id: \"background_color\", label: \"Color\", name: \"color\", value: \"#00000\"}\n\t\t]\n\t};\n}\n\nutil.inherit(BackgroundMenu, SubMenu);\n\nBackgroundMenu.prototype.onMenuCreated = function() {\n\t$$(\"background_color\").attachEvent(\"onChange\", this.onColorChanged);\n\t$$(\"lock_enable\").attachEvent(\"onChange\", this.onLockChanged);\n\n\t//todo: refactor\n\n\tdocument.getElementById(\"load-background\").onchange = function() {\n\t\tservice.msg.emit(\"background/loadTexture\");\n\t};\n};\n\nBackgroundMenu.prototype.onColorChanged = function() {\n\tvar value = $$(\"background_color\").getValue().replace(\"#\", \"0x\");\n\tservice.msg.emit(\"background/changeColor\", value);\n};\n\nBackgroundMenu.prototype.onLoadImage = function() {\n\tdocument.getElementById(\"load-background\").click();\n};\n\nBackgroundMenu.prototype.onRemoveBackground = function() {\n\tservice.msg.emit(\"background/removeTexture\");\n};\n\nBackgroundMenu.prototype.onLockChanged = function() {\n\tservice.msg.emit(\"background/changeLocked\");\n};\nmodule.exports = BackgroundMenu;","var SubMenu = require(\"./SubMenu.js\");\nvar util = require(\"../../util\");\nvar behaviourModel = require(\"../../model\").behaviourModel;\nvar projectModel = require(\"../../model\").projectModel;\nvar service = require(\"../../service\");\n\nfunction ColorMenu() {\n\tSubMenu.call(this);\n\tutil.bind(this);\n\n\tthis.ui = {\n\t\trows: [\n\t\t\tthis.checkbox(\"Enabled:\", {id: \"color_enable\", value: 0}),\n\t\t\tthis.section(\"Start:\"),\n\t\t\t{view: \"template\", content: \"start_color\", autoheight: true},\n\t\t\tthis.section(\"End:\"),\n\t\t\t{view: \"template\", content: \"end_color\", autoheight: true},\n\t\t\tthis.section(\"Start variance:\"),\n\t\t\tthis.colorSlider(\"start_variance_r\", \"R:\"),\n\t\t\tthis.colorSlider(\"start_variance_g\", \"G:\"),\n\t\t\tthis.colorSlider(\"start_variance_b\", \"B:\"),\n\t\t\tthis.slider(\"\", {id: \"start_variance_alpha\", label: \"A:\", labelWidth: 30, min: 0, max: 1, step: 0.01, value: 0}),\n\t\t\tthis.section(\"End variance:\"),\n\t\t\tthis.colorSlider(\"end_variance_r\", \"R:\"),\n\t\t\tthis.colorSlider(\"end_variance_g\", \"G:\"),\n\t\t\tthis.colorSlider(\"end_variance_b\", \"B:\"),\n\t\t\tthis.slider(\"\", {id: \"end_variance_alpha\", label: \"A:\", labelWidth: 30, min: 0, max: 1, step: 0.01, value: 0})\n\n\t\t]\n\t};\n\n\tvar startColor = $(\"#start_color_input\");\n\tvar startColorInfo = $(\"#start_color_info\");\n\tstartColor.spectrum(this.getColorPickerConfig());\n\n\tthis.getStartColor = function() {\n\t\treturn startColor;\n\t};\n\tthis.getStartColorInfo = function() {\n\t\treturn startColorInfo;\n\t};\n\n\tvar endColor = $(\"#end_color_input\");\n\tvar endColorInfo = $(\"#end_color_info\");\n\tendColor.spectrum(this.getColorPickerConfig());\n\n\tthis.getEndColor = function() {\n\t\treturn endColor;\n\t};\n\n\tthis.getEndColorInfo = function() {\n\t\treturn endColorInfo;\n\t};\n}\n\nutil.inherit(ColorMenu, SubMenu);\n\nColorMenu.prototype.getColorPickerConfig = function() {\n\treturn {\n\t\tcolor: \"#ffffff\",\n\t\tshowInput: true,\n\t\tshowAlpha: true,\n\t\tpreferredFormat: \"hex\",\n\t\tclickoutFiresChange: true,\n\t};\n};\n\nColorMenu.prototype.colorSlider = function(id, label) {\n\treturn this.slider.call(this, \"\", {\n\t\tid: id, label: label, labelWidth: 30, min: 0, max: 255, step: 1, value: 0\n\t});\n};\n\nColorMenu.prototype.onMenuCreated = function() {\n\tthis.bind(\"start_variance_r\", \"r\", this.getStartVariance);\n\tthis.bind(\"start_variance_g\", \"g\", this.getStartVariance);\n\tthis.bind(\"start_variance_b\", \"b\", this.getStartVariance);\n\tthis.bind(\"start_variance_alpha\", \"alpha\", this.getStartVariance);\n\n\tthis.bind(\"end_variance_r\", \"r\", this.getEndVariance);\n\tthis.bind(\"end_variance_g\", \"g\", this.getEndVariance);\n\tthis.bind(\"end_variance_b\", \"b\", this.getEndVariance);\n\tthis.bind(\"end_variance_alpha\", \"alpha\", this.getEndVariance);\n\n\t$$(\"color_enable\").attachEvent(\"onChange\", this.onEnableChanged);\n\tservice.msg.on(\"emitter/changed\", this.onEmitterChanged);\n\n\tthis.getStartColor().on(\"move.spectrum\", this.onStartColorChanged);\n\tthis.getStartColor().on(\"hide.spectrum\", this.onStartColorChanged);\n\tthis.getEndColor().on(\"move.spectrum\", this.onEndColorChanged);\n\tthis.getEndColor().on(\"hide.spectrum\", this.onEndColorChanged);\n\n};\n\nColorMenu.prototype.onStartColorChanged = function() {\n\tvar color = this.getStartColor().spectrum(\"get\").toRgb();\n\tthis.getBehaviour().start.set(color.r, color.g, color.b, color.a);\n};\n\nColorMenu.prototype.onEndColorChanged = function() {\n\tvar color = this.getEndColor().spectrum(\"get\").toRgb();\n\tthis.getBehaviour().end.set(color.r, color.g, color.b, color.a);\n};\n\nColorMenu.prototype.onEnableChanged = function(value) {\n\tservice.msg.emit(\"behaviour/setEnable\", value, this.getBehaviour());\n};\n\nColorMenu.prototype.onEmitterChanged = function() {\n\t$$(\"color_enable\").setValue(projectModel.hasActiveBehaviour(this.getBehaviour()));\n\n\tthis.getStartColor().spectrum(\"set\", \"#\" + this.getBehaviour().start.hex.toString(16));\n\tthis.getEndColor().spectrum(\"set\", \"#\" + this.getBehaviour().end.hex.toString(16));\n\n\tthis.refreshColorInfo();\n};\n\nColorMenu.prototype.refreshColorInfo = function() {\n\tthis.getStartColorInfo().text(this.getStartColor().spectrum(\"get\").toRgbString());\n\tthis.getEndColorInfo().text(this.getEndColor().spectrum(\"get\").toRgbString());\n};\n\nColorMenu.prototype.getStartVariance = function() {\n\treturn this.getBehaviour().startVariance;\n};\n\nColorMenu.prototype.getEndVariance = function() {\n\treturn this.getBehaviour().endVariance;\n};\n\nColorMenu.prototype.getBehaviour = function() {\n\treturn behaviourModel.getBehaviourByName(\"ColorBehaviour\");\n};\n\nmodule.exports = ColorMenu;\n\n\n","var SubMenu = require(\"./SubMenu.js\");\nvar LifeMenu = require(\"./LifeMenu.js\");\nvar util = require(\"../../util\");\nvar service = require(\"../../service\");\nvar projectModel = require(\"../../model\").projectModel;\n\nfunction GeneralMenu() {\n\tSubMenu.call(this);\n\tutil.bind(this);\n\n\tthis.lifeMenu = new LifeMenu();\n\n\tthis.ui = {\n\t\trows: [\n\t\t\tthis.section(\"Emitter:\"),\n\t\t\tthis.counter(\"Emit/sec:\", {\n\t\t\t\tid: \"emit_per_second\",\n\t\t\t\tstep: 0.1, value: 20, min: 0, max: 200, align: \"center\", format: webix.i18n.numberFormat\n\t\t\t}),\n\t\t\t{id: \"duration\", view: \"text\", value: -1, label: \"Duration\", labelAlign: \"left\"},\n\t\t\tthis.section(\"Life:\"),\n\t\t\tthis.lifeMenu.ui,\n\t\t\tthis.section(\"Emission Angle:\"),\n\n\t\t]\n\n\t};\n}\n\nutil.inherit(GeneralMenu, SubMenu);\n\nGeneralMenu.prototype.onActive = function() {\n\tSubMenu.prototype.onActive.call(this);\n\tthis.lifeMenu.onActive();\n};\n\nGeneralMenu.prototype.onMenuCreated = function() {\n\t$$(\"emit_per_second\").attachEvent(\"onChange\", this.onEmitPerSecondChanged);\n\t$$(\"duration\").attachEvent(\"onChange\", this.onDurationChanged);\n\tservice.msg.on(\"emitter/changed\", this.onEmitterChanged);\n};\n\nGeneralMenu.prototype.onEmitPerSecondChanged = function(value) {\n\tprojectModel.emitter.emitController.emitPerSecond = value;\n};\n\nGeneralMenu.prototype.onDurationChanged = function(value) {\n\tvalue = parseFloat(value);\n\tif (!isNaN(value)) {\n\t\tprojectModel.emitter.emitController.duration = value;\n\t}\n\n\t$$(\"duration\").setValue(projectModel.emitter.emitController.duration);\n};\n\nGeneralMenu.prototype.onEmitterChanged = function() {\n\t$$(\"emit_per_second\").setValue(projectModel.emitter.emitController.emitPerSecond);\n\t$$(\"duration\").setValue(projectModel.emitter.emitController.duration);\n};\n\nmodule.exports = GeneralMenu;","var SubMenu = require(\"./SubMenu.js\");\nvar util = require(\"../../util\");\nvar service = require(\"../../service\");\nvar behaviourModel = require(\"../../model\").behaviourModel;\n\nfunction LifeMenu() {\n\tSubMenu.call(this);\n\n\tthis.ui = {\n\t\trows: [\n\t\t\tthis.slider(\"Life time:\", {\n\t\t\t\tid: \"life_slider_time\", min: 0, max: 10, step: 0.1, value: 5\n\t\t\t}),\n\t\t\tthis.slider(\"Life variance:\", {\n\t\t\t\tid: \"life_slider_variance\", min: 0, max: 10, step: 0.1, value: 0\n\t\t\t})\n\t\t]\n\t};\n}\n\nutil.inherit(LifeMenu, SubMenu);\n\nLifeMenu.prototype.onMenuCreated = function() {\n\tthis.bind(\"life_slider_time\", \"maxLifeTime\");\n\tthis.bind(\"life_slider_variance\", \"timeVariance\");\n\n\tservice.msg.emit(\"behaviour/setEnable\", true, this.getBehaviour());\n\n\n};\n\nLifeMenu.prototype.getBehaviour = function() {\n\treturn behaviourModel.getBehaviourByName(\"LifeBehaviour\");\n};\n\nmodule.exports = LifeMenu;","var ProjectMenu = require(\"./ProjectMenu.js\");\nvar TextureMenu = require(\"./TextureMenu.js\");\nvar BackgroundMenu = require(\"./BackgroundMenu.js\");\nvar ColorMenu = require(\"./ColorMenu.js\");\nvar AngularVelocityMenu = require(\"./AngularVelocityMenu.js\");\nvar PositionMenu = require(\"./PositionMenu.js\");\nvar SizeMenu = require(\"./SizeMenu.js\");\nvar GeneralMenu = require(\"./GeneralMenu.js\");\nvar service = require(\"../../service\");\n\nfunction Menu() {\n\n\tvar subMenus = [\n\t\t{value: \"Project\", view: new ProjectMenu()},\n\t\t{value: \"Texture\", view: new TextureMenu()},\n\t\t{value: \"Background\", view: new BackgroundMenu()},\n\t\t{$template: \"Separator\"},\n\t\t{value: \"General\", view: new GeneralMenu()},\n\t\t{value: \"Color\", view: new ColorMenu()},\n\t\t{value: \"Position\", view: new PositionMenu()},\n\t\t{value: \"Angular Velocity\", view: new AngularVelocityMenu()},\n\t\t{value: \"Size\", view: new SizeMenu()}\n\t];\n\n\tvar menu = {\n\t\tview: \"menu\", id: \"m1\",\n\t\tlayout: \"y\", width: 200,\n\t\theight: window.innerHeight,\n\t\tselect: true,\n\t\tdata: subMenus,\n\t\ton: {\n\t\t\tonMenuItemClick: this.onMenuItemClick.bind(this)\n\t\t}\n\t};\n\n\tvar uiColumns = [menu];\n\tfor (var i = 0; i < subMenus.length; i++) {\n\t\tvar subMenu = subMenus[i];\n\t\tif (subMenu.view) {\n\t\t\tsubMenu.view.ui.id = \"submenu\" + i;\n\t\t\tsubMenu.view.ui.batch = i.toString();\n\t\t\tuiColumns.push(subMenu.view.ui);\n\t\t}\n\t}\n\n\tuiColumns.push({body: {content: \"stage\"}});\n\n\tthis.ui = webix.ui({\n\t\ttype: \"space\",\n\t\tvisibleBatch: \"1\",\n\t\tcols: uiColumns\n\t});\n\n\twebix.event(window, \"resize\", function() {\n\t\t$$(\"m1\").define(\"height\", window.innerHeight);\n\t}.bind(this));\n\n\tservice.msg.emit(\"menu/created\");\n}\n\nMenu.prototype.onMenuItemClick = function(id) {\n\tvar item = $$(\"m1\").getMenuItem(id);\n\tthis.ui.showBatch(item.view.ui.batch);\n\titem.view.onActive();\n};\nmodule.exports = Menu;","var SubMenu = require(\"./SubMenu.js\");\nvar inherit = require(\"../../util\").inherit;\nvar bind = require(\"../../util\").bind;\nvar behaviourModel = require(\"../../model\").behaviourModel;\nvar projectModel = require(\"../../model\").projectModel;\nvar service = require(\"../../service\");\n\nfunction PositionMenu() {\n\tSubMenu.call(this);\n\tbind(this);\n\n\tthis.ui = {\n\t\trows: [\n\t\t\tthis.checkbox(\"Enabled: \", {id: \"position_enable\", value: 0}),\n\t\t\tthis.section(\"Position: \"),\n\t\t\tthis.positionSlider(\"position_x\", \"X: \"),\n\t\t\tthis.positionSlider(\"position_y\", \"Y: \"),\n\t\t\tthis.varianceSlider(\"position_variance_x\", \"Variance X: \"),\n\t\t\tthis.varianceSlider(\"position_variance_y\", \"Variance Y: \"),\n\t\t\tthis.section(\"Velocity: \"),\n\t\t\tthis.positionSlider(\"velocity_x\", \"X: \"),\n\t\t\tthis.positionSlider(\"velocity_y\", \"Y: \"),\n\t\t\tthis.varianceSlider(\"velocity_variance_x\", \"Variance X: \"),\n\t\t\tthis.varianceSlider(\"velocity_variance_y\", \"Variance Y: \"),\n\t\t\tthis.section(\"Acceleration/Gravity:\"),\n\t\t\tthis.positionSlider(\"acceleration_x\", \"X: \"),\n\t\t\tthis.positionSlider(\"acceleration_y\", \"Y: \"),\n\t\t\tthis.varianceSlider(\"acceleration_variance_x\", \"Variance X: \"),\n\t\t\tthis.varianceSlider(\"acceleration_variance_y\", \"Variance Y: \")\n\n\t\t]\n\t};\n}\n\ninherit(PositionMenu, SubMenu);\n\nPositionMenu.prototype.positionSlider = function(id, label) {\n\tvar slider = this.slider(label, {\n\t\tid: id,\n\t\tlabelWidth: 30,\n\t\tmin: -500,\n\t\tmax: 500,\n\t\tstep: 1,\n\t\tvalue: 0\n\t});\n\n\treturn slider;\n};\n\nPositionMenu.prototype.varianceSlider = function(id, label) {\n\tvar slider = this.slider(label, {\n\t\tid: id,\n\t\tlabelWidth: 30,\n\t\tmin: 0,\n\t\tmax: 500,\n\t\tstep: 1,\n\t\tvalue: 0\n\t});\n\n\treturn slider;\n};\n\nPositionMenu.prototype.onMenuCreated = function() {\n\tthis.bind(\"position_x\", \"x\", this.getPosition);\n\tthis.bind(\"position_y\", \"y\", this.getPosition);\n\tthis.bind(\"position_variance_x\", \"x\", this.getPositionVariance);\n\tthis.bind(\"position_variance_y\", \"y\", this.getPositionVariance);\n\n\tthis.bind(\"velocity_x\", \"x\", this.getVelocity);\n\tthis.bind(\"velocity_y\", \"y\", this.getVelocity);\n\tthis.bind(\"velocity_variance_x\", \"x\", this.getVelocityVariance);\n\tthis.bind(\"velocity_variance_y\", \"y\", this.getVelocityVariance);\n\n\tthis.bind(\"acceleration_x\", \"x\", this.getAcceleration);\n\tthis.bind(\"acceleration_y\", \"y\", this.getAcceleration);\n\tthis.bind(\"acceleration_variance_x\", \"x\", this.getAccelerationVariance);\n\tthis.bind(\"acceleration_variance_y\", \"y\", this.getAccelerationVariance);\n\n\t$$(\"position_enable\").attachEvent(\"onChange\", this.onEnableChanged);\n\tservice.msg.on(\"emitter/changed\", this.onEmitterChanged);\n};\n\nPositionMenu.prototype.onEnableChanged = function(value) {\n\tservice.msg.emit(\"behaviour/setEnable\", value, this.getBehaviour());\n};\n\nPositionMenu.prototype.onEmitterChanged = function() {\n\t$$(\"position_enable\").setValue(projectModel.hasActiveBehaviour(this.getBehaviour()));\n};\n\nPositionMenu.prototype.getPosition = function() {\n\treturn this.getBehaviour().position;\n};\n\nPositionMenu.prototype.getPositionVariance = function() {\n\treturn this.getBehaviour().positionVariance;\n};\n\nPositionMenu.prototype.getVelocity = function() {\n\treturn this.getBehaviour().velocity;\n};\n\nPositionMenu.prototype.getVelocityVariance = function() {\n\treturn this.getBehaviour().velocityVariance;\n};\n\nPositionMenu.prototype.getAcceleration = function() {\n\treturn this.getBehaviour().acceleration;\n};\n\nPositionMenu.prototype.getAccelerationVariance = function() {\n\treturn this.getBehaviour().accelerationVariance;\n};\n\nPositionMenu.prototype.getBehaviour = function() {\n\treturn behaviourModel.getBehaviourByName(\"PositionBehaviour\");\n};\n\nmodule.exports = PositionMenu;\n\n\n","var controller = require(\"../../controller\").projectMenuController;\nvar util = require(\"../../util\");\nvar service = require(\"../../service\");\nvar predefinedModel = require(\"../../model\").predefinedModel;\n\nfunction ProjectMenu() {\n\tutil.bind(this);\n\n\tthis.ui = {\n\t\trows: [\n\t\t\t{view: \"button\", value: \"Save Project\", width: 200, click: this.onSaveProject},\n\t\t\t{view: \"button\", value: \"Load Project\", width: 200, click: this.onLoadProject},\n\t\t\t{view: \"button\", value: \"Export config\", width: 200, click: this.onExportConfig},\n\t\t\t{view: \"button\", value: \"Load config\", width: 200, click: this.onLoadConfig},\n\t\t\t{view: \"button\", value: \"Load predefined\", width: 200, click: this.onLoadPredefined},\n\t\t\t{view: \"button\", value: \"Reset\", width: 200}\n\t\t]\n\t};\n\n\t//todo: refactor\n\tdocument.getElementById(\"load-config\").onchange = function() {\n\t\tservice.msg.emit(\"project/loadConfig\");\n\t};\n\n\tdocument.getElementById(\"load-project\").onchange = function() {\n\t\tservice.msg.emit(\"project/load\");\n\t};\n}\n\nProjectMenu.prototype.onLoadConfig = function() {\n\tdocument.getElementById(\"load-config\").click();\n};\n\nProjectMenu.prototype.onLoadProject = function() {\n\tdocument.getElementById(\"load-project\").click();\n};\n\nProjectMenu.prototype.onSaveProject = function() {\n\tservice.msg.emit(\"project/save\");\n};\n\nProjectMenu.prototype.onExportConfig = function() {\n\tservice.msg.emit(\"project/exportConfig\");\n};\n\nProjectMenu.prototype.onLoadPredefined = function() {\n\tvar data = predefinedModel.getNames().map(function(name) {\n\t\treturn {view: \"text\", value: name};\n\t});\n\n\twebix.ui({\n\t\tview: \"window\",\n\t\tmodal: true,\n\t\thead: {view: \"button\", label: \"close\", align: \"right\", click: (\"$$('choose_predefined_window').close();\")},\n\t\tposition: \"center\",\n\t\tid: \"choose_predefined_window\",\n\t\tbody: {\n\t\t\tview: \"menu\",\n\t\t\tid: \"choose_predefined_menu\",\n\t\t\tselect: true,\n\t\t\tdata: data,\n\t\t\tlayout: \"y\",\n\t\t\tscroll: \"y\",\n\t\t\theight: 300,\n\t\t\ton: {\n\t\t\t\tonMenuItemClick: this.onPredefinedClick\n\t\t\t}\n\t\t}\n\t}).show();\n};\n\nProjectMenu.prototype.onPredefinedClick = function(id) {\n\tservice.msg.emit(\"project/loadPredefined\", $$(\"choose_predefined_menu\").getMenuItem(id).value);\n\t$$(\"choose_predefined_window\").hide();\n\t$$(\"choose_predefined_window\").close();\n};\n\nmodule.exports = ProjectMenu;","var SubMenu = require(\"./SubMenu.js\");\nvar util = require(\"../../util\");\nvar behaviourModel = require(\"../../model\").behaviourModel;\nvar projectModel = require(\"../../model\").projectModel;\nvar service = require(\"../../service\");\n\nfunction SizeMenu() {\n\tSubMenu.call(this);\n\tutil.bind(this);\n\n\tthis.ui = {\n\t\trows: [\n\t\t\tthis.checkbox(\"Enabled: \", {id: \"size_enable\", value: 0}),\n\t\t\tthis.section(\"Start size: \"),\n\t\t\tthis.positionSlider(\"start_size_x\", \"X: \"),\n\t\t\tthis.positionSlider(\"start_size_y\", \"Y: \"),\n\t\t\tthis.varianceSlider(\"start_size_variance\", \"Variance: \"),\n\n\t\t\tthis.section(\"End size: \"),\n\t\t\tthis.positionSlider(\"end_size_x\", \"X: \"),\n\t\t\tthis.positionSlider(\"end_size_y\", \"Y: \"),\n\t\t\tthis.varianceSlider(\"end_size_variance\", \"Variance: \")\n\t\t]\n\t};\n}\n\nutil.inherit(SizeMenu, SubMenu);\n\nSizeMenu.prototype.positionSlider = function(id, label) {\n\tvar slider = this.slider(label, {\n\t\tid: id,\n\t\tlabelWidth: 30,\n\t\tmin: 0,\n\t\tmax: 10,\n\t\tvalue: 1\n\t});\n\n\treturn slider;\n};\n\nSizeMenu.prototype.varianceSlider = function(id, label) {\n\tvar slider = this.slider(label, {\n\t\tid: id,\n\t\tlabelWidth: 30,\n\t\tmin: 0,\n\t\tmax: 10,\n\t\tvalue: 0\n\t});\n\n\treturn slider;\n};\n\nSizeMenu.prototype.onMenuCreated = function() {\n\tthis.bind(\"start_size_x\", \"x\", this.getSizeStart);\n\tthis.bind(\"start_size_y\", \"y\", this.getSizeStart);\n\tthis.bind(\"end_size_x\", \"x\", this.getSizeEnd);\n\tthis.bind(\"end_size_y\", \"y\", this.getSizeEnd);\n\tthis.bind(\"start_size_variance\", \"startVariance\");\n\tthis.bind(\"end_size_variance\", \"endVariance\");\n\n\t$$(\"size_enable\").attachEvent(\"onChange\", this.onEnableChanged);\n\tservice.msg.on(\"emitter/changed\", this.onEmitterChanged);\n};\n\nSizeMenu.prototype.onEnableChanged = function(value) {\n\tservice.msg.emit(\"behaviour/setEnable\", value, this.getBehaviour());\n};\n\nSizeMenu.prototype.onEmitterChanged = function() {\n\t$$(\"size_enable\").setValue(projectModel.hasActiveBehaviour(this.getBehaviour()));\n};\n\nSizeMenu.prototype.getSizeStart = function() {\n\treturn this.getBehaviour().sizeStart;\n};\n\nSizeMenu.prototype.getSizeEnd = function() {\n\treturn this.getBehaviour().sizeEnd;\n};\n\nSizeMenu.prototype.getBehaviour = function() {\n\treturn behaviourModel.getBehaviourByName(\"SizeBehaviour\");\n};\n\nmodule.exports = SizeMenu;\n\n\n","var extension = require(\"../extension\");\nvar service = require(\"../../service\");\n\nfunction SubMenu() {\n\tthis.WIDTH = 200;\n\tservice.msg.on(\"menu/created\", this.onMenuCreated.bind(this));\n}\n\nSubMenu.prototype.onMenuCreated = function() {\n};\n\nSubMenu.prototype.bind = function(id, propertyName, getTargetFunction) {\n\tgetTargetFunction = getTargetFunction || this.getBehaviour;\n\n\t$$(id).onChanged = function(newValue) {\n\t\t//console.log(\"onChanged\", id, newValue, getTargetFunction());\n\t\tgetTargetFunction()[propertyName] = newValue;\n\t};\n\n\tservice.msg.on(\"emitter/changed\", function() {\n\t\t//console.log(\"emitter/change\", id, getTargetFunction()[propertyName]);\n\n\t\tvar setValue = $$(id).config.setValue || $$(id).setValue;\n\t\tsetValue(getTargetFunction()[propertyName], getTargetFunction());\n\t\t$$(id).refresh();\n\t});\n};\n\nSubMenu.prototype.onActive = function() {\n\tvar rows = this.ui.rows;\n\tfor (var i = 0; i < rows.length; i++) {\n\t\tif($$(rows[i].id).refresh){\n\t\t\t$$(rows[i].id).refresh();\n\n\t\t}\n\t}\n};\n\nSubMenu.prototype.getBehaviour = function() {\n\tthrow new Error(\"Has to be overriden\");\n};\n\nSubMenu.prototype.button = function(label, style) {\n\treturn this._setup({view: \"button\", value: label}, style);\n};\n\nSubMenu.prototype.counter = function(label, style) {\n\treturn this._setup({view: \"counter\", label: label}, style);\n};\n\nSubMenu.prototype.section = function(label) {\n\treturn {view: \"template\", template: label, type: \"section\"};\n\t//return {view: \"label\", label: label, width: this.WIDTH, height: 30, align: \"center\"};\n};\n\nSubMenu.prototype.title = function(label) {\n\t//return {view: \"template\", template: label, width: this.WIDTH, type: \"section\"};\n\treturn {view: \"label\", label: label, height: 30, align: \"center\"};\n};\n\nSubMenu.prototype.checkbox = function(label, style) {\n\treturn this._setup({view: \"checkbox\", label: label}, style);\n};\n\nSubMenu.prototype.slider = function(title, style) {\n\tstyle = extension.slider(title, style);\n\treturn this._setup({view: \"slider\"}, style);\n\n};\n\nSubMenu.prototype._setup = function(defaultStyle, extraStyle) {\n\textraStyle = extraStyle || {};\n\tdefaultStyle.width = this.WIDTH;\n\tdefaultStyle.id = extraStyle.id || webix.uid();\n\treturn Object.assign(defaultStyle, extraStyle);\n};\n\nmodule.exports = SubMenu;","var SubMenu = require(\"./SubMenu.js\");\nvar util = require(\"../../util\");\nvar service = require(\"../../service\");\n\nvar controller = require(\"../../controller\").textureMenuController;\nvar texturesModel = require(\"../../model\").texturesModel;\n\nfunction TextureMenu() {\n\tSubMenu.call(this);\n\tutil.bind(this);\n\n\tthis.ui = {\n\t\trows: [\n\t\t\t//this.button(\"Export texture\"),\n\t\t\tthis.button(\"Upload texture\", {click: this.onUploadTexture}),\n\t\t\tthis.button(\"Show all\", {click: this.onShowAll}),\n\t\t\tthis.texturePreview()\n\t\t]\n\t};\n\n\t//todo: refactor\n\tdocument.getElementById(\"load-texture\").onchange = function() {\n\t\tservice.msg.emit(\"texture/upload\");\n\t};\n}\n\nutil.inherit(TextureMenu, SubMenu);\n\nmodule.exports = TextureMenu;\n\nTextureMenu.prototype.onUploadTexture = function() {\n\tdocument.getElementById(\"load-texture\").click();\n};\n\nTextureMenu.prototype.texturePreview = function() {\n\treturn {\n\t\tview: \"carousel\",\n\t\tid: \"carousel\",\n\t\twidth: 100, height: 100,\n\t\tcols: this.getTexturesPreviewData(),\n\t\tnavigation: {\n\t\t\titems: false\n\t\t}\n\t};\n\n};\n\nTextureMenu.prototype.onMenuCreated = function() {\n\t$$(\"carousel\").attachEvent(\"onShow\", function(name) {\n\t\tservice.msg.emit(\"texture/change\", name);\n\t});\n};\n\nTextureMenu.prototype.onShowAll = function() {\n\tthis.texturesWindow = webix.ui({\n\t\tview: \"window\",\n\t\tbody: {\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tview: \"dataview\",\n\t\t\t\t\tyCount: 2,\n\t\t\t\t\txCount: 2,\n\t\t\t\t\tselect: true,\n\t\t\t\t\tscroll: true,\n\t\t\t\t\ttype: {\n\t\t\t\t\t\twidth: 100,\n\t\t\t\t\t\theight: 100\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: imageTemplate,\n\t\t\t\t\tdata: this.getTexturesViewData(),\n\t\t\t\t\tclick: this.onMenuItemClick.bind(this)\n\n\t\t\t\t}\n\t\t\t]\n\n\t\t},\n\t\thead: false,\n\t\ttop: 100,\n\t\tleft: 100,\n\t\twidth: 600,\n\t\theight: 500\n\t});\n\n\tthis.texturesWindow.show();\n};\n\nTextureMenu.prototype.onMenuItemClick = function(name) {\n\tthis.texturesWindow.hide();\n\t$$(\"carousel\").setActive(name);\n};\n\nTextureMenu.prototype.getTexturesPreviewData = function() {\n\treturn texturesModel.getTextures().map(function(texture) {\n\t\treturn {id: texture.name, css: \"image\", template: imageTemplate, data: {src: texture.url}};\n\t});\n};\n\nTextureMenu.prototype.getTexturesViewData = function() {\n\treturn texturesModel.getTextures().map(function(texture) {\n\t\treturn {id: texture.name, src: texture.url, title: texture.name};\n\t});\n};\n\nfunction imageTemplate(obj) {\n\treturn \"<div class='texture-preview'><img src='\" + obj.src + \"' class='texture-preview-content' ondragstart='return false'/></div>\";\n}\n\n\n\n","module.exports = {\n\tMenu: require(\"./Menu.js\"),\n\tProjectMenu: require(\"./ProjectMenu.js\")\n};","var util = require(\"../../util\");\nvar service = require(\"../../service\");\nvar StageBackground = require(\"./StageBackground.js\");\nvar Marker = require(\"../Marker.js\");\nvar projectModel = require(\"../../model\").projectModel;\n\nfunction Stage(rect) {\n\tPIXI.Container.call(this);\n\tutil.bind(this);\n\n\tthis.rect = rect;\n\tthis.hitArea = rect;\n\tthis.interactive = true;\n\tthis.hasFocus = false;\n\n\tthis.mouseover = function() {\n\t\tservice.msg.emit(\"stage/mouseOver\");\n\t};\n\n\tthis.mouseout = function() {\n\t\tservice.msg.emit(\"stage/mouseOut\");\n\t};\n\n\tvar background = this.addChild(new StageBackground());\n\tbackground.x = rect.width / 2;\n\tbackground.y = rect.height / 2;\n\n\tthis.marker = this.addChild(new Marker(this.onMarkerDrag));\n\tprojectModel.on(\"markerPosition/changed\", this.onMarkerPositionChanged);\n\n\tthis.onMarkerPositionChanged();\n}\n\nutil.inherit(Stage, PIXI.Container);\n\nStage.prototype.onMarkerDrag = function(position) {\n\tprojectModel.markerPositionInStageCoordinates = position;\n};\n\nStage.prototype.onMarkerPositionChanged = function() {\n\tthis.marker.position = projectModel.markerPositionInStageCoordinates;\n};\n\nmodule.exports = Stage;","var util = require(\"../../util\");\nvar service = require(\"../../service\");\nvar backgroundModel = require(\"../../model\").backgroundModel;\n\nfunction StageBackground() {\n\tPIXI.Container.call(this);\n\tutil.bind(this);\n\n\tbackgroundModel.on(\"isLocked/changed\", this.onIsLockedChanged);\n\tbackgroundModel.on(\"texture/changed\", this.onTextureChanged);\n\tbackgroundModel.on(\"imagePosition/changed\", this.onPositionChanged);\n\n\tthis.mousedown = this.touchstart = this.onMouseDown;\n\tthis.mouseup = this.mouseupoutside = this.touchend = this.touchendoutside = this.onMouseUp;\n\tthis.mousemove = this.touchmove = this.onMouseMove;\n\n\tthis.onIsLockedChanged();\n}\n\nutil.inherit(StageBackground, PIXI.Container);\n\nStageBackground.prototype.onIsLockedChanged = function() {\n\tthis.interactive = !backgroundModel.isLocked;\n\tthis.buttonMode = !backgroundModel.isLocked;\n};\n\nStageBackground.prototype.onTextureChanged = function() {\n\tif (!backgroundModel.texture && this.image) {\n\t\tthis.removeChild(this.image);\n\t\tthis.image = null;\n\t}\n\telse {\n\t\tthis.image = this.image || this.createImage();\n\t\tthis.image.texture = backgroundModel.texture;\n\t\tthis.onPositionChanged();\n\t}\n};\n\nStageBackground.prototype.onPositionChanged = function() {\n\tif (this.image) {\n\t\tthis.image.x = backgroundModel.imagePosition.x;\n\t\tthis.image.y = backgroundModel.imagePosition.y;\n\t}\n};\n\nStageBackground.prototype.createImage = function() {\n\tvar image = new PIXI.Sprite(PIXI.Texture.EMPTY);\n\timage.anchor.set(0.5, 0.5);\n\treturn this.addChild(image);\n};\n\nStageBackground.prototype.onMouseDown = function() {\n\tthis.dragging = true;\n};\n\nStageBackground.prototype.onMouseUp = function() {\n\tthis.dragging = false;\n};\n\nStageBackground.prototype.onMouseMove = function(event) {\n\tif (this.dragging) {\n\t\tvar newPosition = event.data.getLocalPosition(this);\n\t\tbackgroundModel.imagePosition = newPosition.clone();\n\t}\n};\n\nmodule.exports = StageBackground;"]}